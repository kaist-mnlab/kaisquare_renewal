/**
 * ParamQuery Grid a.k.a. pqGrid v1.0.8
 * 
 * Copyright (c) 2012 Paramvir Dhindsa (http://paramquery.com)
 * Released under MIT license
 * http://paramquery.com/license
 * 
 */     	
(function(a){a.paramquery={xmlToArray:function(d,e){var c=e.itemParent;var g=e.itemNames;var b=[];var f=a(d).find(c);f.each(function(k,l){var j=a(l);var h=[];a(g).each(function(i,m){h.push(j.find(m).text())});b.push(h)});return b},tableToArray:function(h){var i=a(h);var c=[];var f=[];var g=[];var e=[];var b=i.find("tr:first");var d=i.find("tr:eq(1)");b.find("th,td").each(function(p,m){var j=a(m);var r=j.html();var k=j.width();var s="string";var n=d.find("td:eq("+p+")");var l=n.text();var q=n.attr("align");l=l.replace(/,/g,"");if(parseInt(l)==l&&(parseInt(l)+"").length==l.length){s="integer"}else{if(parseFloat(l)==l){s="float"}}var o={title:r,width:k,dataType:s,align:q,dataIndx:p};c.push(o)});i.find("tr").each(function(k,m){if(k==0){return}var l=a(m);var j=[];l.find("td").each(function(n,o){j.push(a.trim(a(o).html()))});f.push(j)});return{data:f,colModel:c}},formatCurrency:function(h){h=Math.round(h*10)/10;h=h+"";if(h.indexOf(".")==-1){h=h+".0"}var c=h.length;var e=h.substring(0,c-2),g=h.substring(c-2,c),b=e.match(/\d/g).reverse(),d=[];for(var f=0;f<b.length;f++){if(f>0&&f%3==0){d.push(",")}d.push(b[f])}d=d.reverse();e=d.join("");return e+g}}})(jQuery);(function(b){var a={};a.options={currentPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20,change:null};a._create=function(){var c=this;this.element.addClass("pq-pager").css({});this.first=b("<button type='button' title='First Page'></button>",{}).appendTo(this.element).button({icons:{primary:"pq-page-first"},text:false}).bind("click.paramquery",function(d){if(c.options.currentPage>1){if(c._trigger("change",d,{curPage:1})!==false){c.option({currentPage:1})}}});this.prev=b("<button type='button' title='Previous Page'></button>").appendTo(this.element).button({icons:{primary:"pq-page-prev"},text:false}).bind("click",function(d){if(c.options.currentPage>1){var e=c.options.currentPage-1;if(c._trigger("change",d,{curPage:e})!==false){c.option({currentPage:e})}}});b("<span class='pq-separator'></span>").appendTo(this.element);b("<span>Page </span>",{}).appendTo(this.element);this.page=b("<input type='text' tabindex='0' />").appendTo(this.element).bind("change",function(d){var e=b(this);var f=e.val();if(isNaN(f)||f<1){e.val(c.options.currentPage);return false}f=parseInt(f);if(f>c.options.totalPages){e.val(c.options.currentPage);return false}if(c._trigger("change",d,{curPage:f})!==false){c.option({currentPage:f})}else{e.val(c.options.currentPage);return false}});b("<span>of </span>",{}).appendTo(this.element);this.$total=b("<span class='total'></span>",{}).appendTo(this.element);b("<span class='pq-separator'></span>").appendTo(this.element);this.next=b("<button type='button' title='Next Page'></button>").appendTo(this.element).button({icons:{primary:"pq-page-next"},text:false}).bind("click",function(d){var e=c.options.currentPage+1;if(c._trigger("change",d,{curPage:e})!==false){c.option({currentPage:e})}});this.last=b("<button type='button' title='Last Page'></button>").appendTo(this.element).button({icons:{primary:"pq-page-last"},text:false}).bind("click",function(d){var e=c.options.totalPages;if(c._trigger("change",d,{curPage:e})!==false){c.option({currentPage:e})}});b("<span class='pq-separator'></span>").appendTo(this.element);b("<span>Records per page: </span>").appendTo(this.element);this.$rPP=b("<select></select>").appendTo(this.element).change(function(d){var e=b(this).val();if(c._trigger("change",d,{rPP:e})!==false){c.options.rPP=e}});b("<span class='pq-separator'></span>").appendTo(this.element);this.$refresh=b("<button type='button' title='Refresh'></button>").appendTo(this.element).button({icons:{primary:"pq-refresh"},text:false}).bind("click",function(d){if(c._trigger("refresh",d)!==false){}});b("<span class='pq-separator'></span>").appendTo(this.element);this.$msg=b("<span class='pq-pager-msg'></span>").appendTo(this.element);this._refresh()};a._refresh=function(){var e=(this.$rPP);e.empty();var c=this.options.rPPOptions;for(var f=0;f<c.length;f++){var d=document.createElement("option");d.text=c[f];d.value=c[f];d.setAttribute("value",c[f]);d.innerHTML=c[f];e.append(d)}e.find("option[value="+this.options.rPP+"]").attr("selected",true);if(this.options.currentPage>=this.options.totalPages){this.next.button({disabled:true});this.last.button({disabled:true})}else{this.next.button({disabled:false});this.last.button({disabled:false})}if(this.options.currentPage<=1){this.first.button({disabled:true});this.prev.button({disabled:true})}else{this.first.button({disabled:false});this.prev.button({disabled:false})}this.page.val(this.options.currentPage);this.$total.text(this.options.totalPages);if(this.options.totalRecords>0){var g=this.options.rPP;var h=this.options.currentPage;var j=this.options.totalRecords;var l=(h-1)*g;var k=h*g;if(k>j){k=j}this.$msg.html("Displaying "+(l+1)+" to "+(k)+" of "+j+" items.")}else{this.$msg.html("")}};a._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection();_super()};a._setOption=function(c,d){if(c=="currentPage"||c=="totalPages"){d=parseInt(d)}b.Widget.prototype._setOption.call(this,c,d)};a._setOptions=function(){b.Widget.prototype._setOptions.apply(this,arguments);this._refresh()};b.widget("paramquery.pqPager",a)})(jQuery);(function(b){var a={};a.options={length:200,num_eles:3,cur_pos:0,timeout:350,pace:"optimum",direction:"vertical"};a._destroy=function(){this.element.removeClass("pq-scrollbar-vert").enableSelection().removeClass("pq-scrollbar-horiz").unbind("click.pq-scrollbar").empty();this.element.removeData()};a._create=function(){this.length=this.options.length;this.direction=this.options.direction;this.num_eles=this.options.num_eles;var e=this;var f=this.element.empty();if(this.direction=="vertical"){f.addClass("pq-scrollbar-vert");f.html("<div class='top-btn pq-sb-btn'></div>			<div class='pq-sb-slider'>				<div class='vert-slider-top'></div>				<div class='vert-slider-bg'></div>				<div class='vert-slider-center'></div>				<div class='vert-slider-bg'></div>				<div class='vert-slider-bottom'></div>			</div>		<div class='bottom-btn pq-sb-btn'></div>")}else{f.addClass("pq-scrollbar-horiz");f.width(this.width);f.html("<div class='left-btn pq-sb-btn'></div>			<div class='pq-sb-slider pq-sb-slider-h'>				<span class='horiz-slider-left'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-center'></span><span class='horiz-slider-bg'></span><span class='horiz-slider-right'></span>			</div>		<div class='right-btn pq-sb-btn'></div>")}this.element.disableSelection().bind("click.pq-scrollbar",function(i){if(e.options.disabled){return}if(e.$slider.is(":hidden")){return}if(e.direction=="vertical"){var n=i.pageY;var l=e.element.offset().top;var k=l+e.length;var h=e.$slider.offset().top;var j=h+e.$slider.height();if(n<h&&n>l+17){var o=n-l;e.$slider.css("top",o);e._updateCurPosAndTrigger(i)}else{if(n>j&&n<k-17){e.$slider.css("top",n-l-e.$slider.height());e._updateCurPosAndTrigger(i)}}}else{var m=i.pageX;var h=e.$slider.offset().left;var j=h+e.$slider.width();if(m<h){e.$slider.css("left",m-e.element.offset().left);e._updateCurPosAndTrigger(i)}else{if(m>j){e.$slider.css("left",m-e.element.offset().left-e.$slider.width());e._updateCurPosAndTrigger(i)}}}});var d="x";if(this.direction=="vertical"){d="y"}this.$slider=b("div.pq-sb-slider",this.element).draggable({axis:d,helper:function(h,i){e._setDragLimits();return this},start:function(h){e.topWhileDrag=null},drag:function(h){e.dragging=true;var i=e.options.pace;if(i=="optimum"){e._setNormalPace(h)}else{if(i=="fast"){e._updateCurPosAndTrigger(h)}}},stop:function(h){e._updateCurPosAndTrigger(h);e.dragging=false;e._refresh()}});function c(h){if(e.options.cur_pos>0){e.options.cur_pos--;e.updateSliderPos();e.scroll(h)}}this.$top_btn=b("div.top-btn,div.left-btn",this.element).click(function(h){if(e.options.disabled){return}c(h);h.preventDefault();return false}).mousedown(function(h){if(e.options.disabled){return}e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){c(h)},50)},e.options.timeout)}).bind("mouseup mouseout",function(h){if(e.options.disabled){return}e._mouseup(h)});function g(h){if(e.options.cur_pos<e.num_eles-1){e.options.cur_pos++}e.updateSliderPos();e.scroll(h)}this.$bottom_btn=b("div.bottom-btn,div.right-btn",this.element).click(function(h){if(e.options.disabled){return}g(h);h.preventDefault();return false}).mousedown(function(h){if(e.options.disabled){return}e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){g(h)},50)},e.options.timeout)}).bind("mouseup mouseout",function(h){if(e.options.disabled){return}e._mouseup(h)});this._refresh()};a._mouseup=function(c){if(this.options.disabled){return}var d=this;window.clearTimeout(d.mousedownTimeout);d.mousedownTimeout=null;window.clearInterval(d.mousedownInterval);d.mousedownInterval=null};a._setDragLimits=function(){if(this.direction=="vertical"){var c=this.element.offset().top+17;var d=(c+this.length-34-this.slider_length);this.$slider.draggable("option","containment",[0,c,0,d])}else{var c=this.element.offset().left+17;var d=(c+this.length-34-this.slider_length);this.$slider.draggable("option","containment",[c,0,d,0])}};a._refresh=function(){if(this.options.num_eles<=1){this.element.css("display","none")}else{this.element.css("display","")}this.num_eles=this.options.num_eles;this.length=this.options.length;this._validateCurPos();this.$slider.css("display","");if(this.direction=="vertical"){this.element.height(this.length);this._setSliderBgLength();this.scroll_space=this.length-34-this.slider_length;if(this.scroll_space<4||this.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(this.options.cur_pos)}else{this.element.width(this.length);this._setSliderBgLength();this.scroll_space=this.length-34-this.slider_length;if(this.scroll_space<4||this.num_eles<=1){this.$slider.css("display","none")}this.updateSliderPos(this.options.cur_pos)}};a._setSliderBgLength=function(){var e=this.length;var f=this.num_eles*40+e;var d=e-34;var c=d*e/f;var g=Math.round((c-(8+3+3))/2);if(g<1){g=1}this.slider_length=8+3+3+2*g;if(this.direction=="vertical"){b("div.vert-slider-bg",this.element).height(g);this.$slider.height(this.slider_length)}else{b(".horiz-slider-bg",this.element).width(g);this.$slider.width(this.slider_length)}};a._updateCurPosAndTrigger=function(c,g){var e=this;var h=e.$slider;if(g==null){g=(e.direction=="vertical")?parseInt(h[0].style.top):parseInt(h[0].style.left)}var f=e.length-34-((e.direction=="vertical")?h[0].offsetHeight:h[0].offsetWidth);var d=(g-17)*(e.num_eles-1)/f;d=Math.round(d);if(e.options.cur_pos!=d){if(this.dragging){if(this.topWhileDrag!=null){if(this.topWhileDrag<g&&e.options.cur_pos>d){return}else{if(this.topWhileDrag>g&&e.options.cur_pos<d){return}}}this.topWhileDrag=g}e.options.cur_pos=d;this.scroll(c)}};a._setNormalPace=function(c){if(this.timer){window.clearInterval(this.timer);this.timer=null}var d=this;d.timer=window.setInterval(function(){var f=d.$slider;var e=(d.direction=="vertical")?parseInt(f[0].style.top):parseInt(f[0].style.left);if(d.prev_top==e){d._updateCurPosAndTrigger(c,e);window.clearInterval(d.timer);d.timer=null}d.prev_top=e},20)};a.setNumEles=function(c){this.num_eles=this.options.num_eles=c;this.updateSliderPos()};a._validateCurPos=function(){if(this.options.cur_pos>=this.num_eles){this.options.cur_pos=this.num_eles-1}if(this.options.cur_pos<0){this.options.cur_pos=0}};a.updateSliderPos=function(){var c=(this.scroll_space*(this.options.cur_pos))/(this.num_eles-1);if(this.direction=="vertical"){this.$slider.css("top",17+c)}else{this.$slider.css("left",17+c)}};a.scroll=function(c){var d=this.options;this._trigger("scroll",c,{cur_pos:d.cur_pos,num_eles:d.num_eles})};a._setOption=function(c,d){if(c=="disabled"){if(d==true){this.$slider.draggable("disable")}else{this.$slider.draggable("enable")}}b.Widget.prototype._setOption.call(this,c,d)};a._setOptions=function(){b.Widget.prototype._setOptions.apply(this,arguments);this._refresh()};b.widget("paramquery.pqScrollBar",a)})(jQuery);(function(f){var c=function(g){this.that=g;this.options=g.options;this.selectedRows=[];this.isDirty=false};var b=c.prototype;b._addToData=function(g){var h=this.options.dataModel.location;var k=(h=="remote")?this.that.data:this.options.dataModel.data,j=(h=="remote")?g.rowIndxPage:g.rowIndx,m=k[j],l=m.length,i=m[l-1];if(i.pqData){i.selectedRow=true}else{m[l]={pqData:true,selectedRow:true}}};b.setDirty=function(){if(this.selectedRows.length>0){this.isDirty=true}};b.removeAll=function(h){if(this.isDirty){this.refresh()}var m=h.raiseEvent,l=this.that,o=(h.offset==null)?l.getRowIndxOffset():obj.offset;var n=this.selectedRows.slice(0);for(var j=0;j<n.length;j++){var g=n[j];var k=g.rowIndx;this.remove({rowIndx:k,offset:o})}};b.refresh=function(){this.selectedRows=[];var k=this.options.dataModel.data;if(!k){return}for(var j=0,g=k.length;j<g;j++){var l=k[j],h=l[l.length-1];if(h&&h.pqData){if(h.selectedRow){this.selectedRows.push({rowIndx:j})}}}this.isDirty=false};b.replace=function(i){if(this.isDirty){this.refresh()}var h=i.rowIndx,j=i.offset=(i.offset==null)?this.that.getRowIndxOffset():i.offset,g=i.rowIndxPage=h-j;$tr=i.$tr,evt=i.evt;this.removeAll({raiseEvent:true});this.add(i)};b.add=function(r){if(this.isDirty){this.refresh()}var k=r.rowIndx,n=this.that,j=(r.offset==null)?n.getRowIndxOffset():r.offset,g=r.rowIndxPage=k-j,m=r.$tr,q=r.evt,i=this.selectedRows,h=this.isSelected(r);if(h==null){return false}else{if(this.isSelected(r)==false){var o=this._boundRow(r),m=o;i.push({rowIndx:k});this._addToData(r);n._trigger("rowSelect",q,{rowIndx:k,rowIndxPage:g,data:n.data,dataModel:n.dataModel,$tr:m})}else{var l=this.indexOf(r);var p=this.selectedRows.splice(l,1);this.selectedRows=this.selectedRows.concat(p)}}};b.remove=function(p){if(this.isDirty){this.refresh()}var j=p.rowIndx,m=this.that,i=(p.offset==null)?m.getRowIndxOffset():p.offset,g=p.rowIndxPage=j-i,n=p.evt,o=(m.init+i-m.offsetRow),h=(m["final"]+i-m.offsetRow);if(this.isSelected(p)){if(j>=o&&j<=h){var l=m.getRow({rowIndxPage:g});if(l){l.removeClass("pq-row-select")}m._trigger("rowUnSelect",n,{rowIndx:j,dataModel:m.dataModel,$tr:l})}this._removeFromData(p)}var k=this.indexOf(p);if(k!=-1){this.selectedRows.splice(k,1)}};b.indexOf=function(k){if(this.isDirty){this.refresh()}var h=k.rowIndx,j=this.selectedRows;for(var g=0;g<j.length;g++){if(j[g].rowIndx==h){return g}}return -1};b.isSelected=function(g){if(this.isDirty){this.refresh()}var h=this.options.dataModel.location;var l=(h=="remote")?this.that.data:this.options.dataModel.data,j=(h=="remote")?g.rowIndxPage:g.rowIndx,k=l[j],m=(k)?k.length:null,i=(m)?k[m-1]:null;if(i==null){return null}else{if(i.pqData){return(i.selectedRow)?true:false}else{return false}}};b.getSelection=function(){if(this.isDirty){this.refresh()}return this.selectedRows};b._removeFromData=function(g){var h=this.options.dataModel.location;var k=(h=="remote")?this.that.data:this.options.dataModel.data,j=(h=="remote")?g.rowIndxPage:g.rowIndx,m=k[j],l=m.length,i=m[l-1];if(i.pqData){i.selectedRow=false}};b._boundRow=function(k){var g=k.rowIndxPage,j=k.rowIndx,i=this.that,h=(k.$tr==null)?i.getRow({rowIndxPage:g}):k.$tr;if(h==null||h.length==0){return false}h.addClass("pq-row-select");return h};var a=function(g){this.options=g.options,this.that=g,this.selectedCells=[]};var e=a.prototype;e._addToData=function(g){var h=this.options.dataModel.location;var k=(h=="remote")?this.that.data:this.options.dataModel.data,j=(h=="remote")?g.rowIndxPage:g.rowIndx,m=k[j],l=m.length,i=m[l-1];if(i.pqData){if(!i.selectedDataIndices){i.selectedDataIndices={}}i.selectedDataIndices[g.dataIndx]=true}else{m[l]={pqData:true,selectedDataIndices:{}};m[l].selectedDataIndices[g.dataIndx]=true}};e._removeFromData=function(g){var h=this.options.dataModel.location;var k=(h=="remote")?this.that.data:this.options.dataModel.data,j=(h=="remote")?g.rowIndxPage:g.rowIndx,m=k[j],l=m.length,i=m[l-1];if(i.pqData&&i.selectedDataIndices){i.selectedDataIndices[g.dataIndx]=false}};e.setDirty=function(){if(this.selectedCells.length>0){this.isDirty=true}};e.removeAll=function(p){if(this.isDirty){this.refresh()}var g=p.raiseEvent,m=this.that,h=(p.offset==null)?m.getRowIndxOffset():obj.offset;var o=this.selectedCells.slice(0);for(var k=0;k<o.length;k++){var l=o[k];var j=l.rowIndx,n=l.dataIndx;this.remove({rowIndx:j,offset:h,dataIndx:n})}};e.isSelected=function(p){if(this.isDirty){this.refresh()}var o=this.options.dataModel.location;var m=this.that,j=(o=="remote")?m.data:this.options.dataModel.data,l=(o=="remote")?p.rowIndxPage:p.rowIndx,n=(p.dataIndx==null)?m.colModel[p.colIndx].dataIndx:p.dataIndx,g=j[l],i=(g)?g.length:null,h=(i)?g[i-1]:null;if(h==null){return null}else{if(h.pqData){var k=h.selectedDataIndices;if(k&&k[n]!=null){return k[n]}}}return false};e.refresh=function(){this.selectedCells=[];var m=this.options.dataModel.data;if(!m){return}for(var l=0,g=m.length;l<g;l++){var n=m[l],h=n[n.length-1];if(h&&h.pqData){var k=h.selectedDataIndices;if(k){for(var j in k){if(k[j]){this.selectedCells.push({rowIndx:l,dataIndx:j})}}}}}this.isDirty=false};e.replace=function(j){if(this.isDirty){this.refresh()}var h=j.rowIndx,i=j.colIndx,k=j.offset=(j.offset==null)?this.that.getRowIndxOffset():j.offset,g=j.rowIndxPage=h-k;$td=j.$td,evt=j.evt;this.removeAll({raiseEvent:true});this.add(j)};e.add=function(s){if(this.isDirty){this.refresh()}var l=s.rowIndx,n=this.that,k=(s.offset==null)?n.getRowIndxOffset():s.offset,g=s.rowIndxPage=l-k,j=s.colIndx=(s.colIndx==null)?n.getColIndxFromDataIndx(s.dataIndx):s.colIndx,o=s.dataIndx=(s.dataIndx==null)?n.colModel[j].dataIndx:s.dataIndx,r=s.evt,q=this.selectedCells,i=this.isSelected(s);if(i==null){return false}else{if(i==false){var h=n.getCell({rowIndxPage:g,colIndx:j});if(h){h.addClass("pq-cell-select")}q.push({rowIndx:l,dataIndx:o});this._addToData(s);n._trigger("cellSelect",r,{rowIndx:l,rowIndxPage:g,colIndx:j,dataIndx:o,data:n.data,dataModel:n.dataModel,$td:h})}else{var m=this.indexOf(s);var p=this.selectedCells.splice(m,1);this.selectedCells=this.selectedCells.concat(p)}}};e.remove=function(r){if(this.isDirty){this.refresh()}var l=r.rowIndx,n=this.that,o=(r.dataIndx==null)?n.colModel[r.colIndx].dataIndx:r.dataIndx,i=(r.colIndx==null)?n.getColIndxFromDataIndx(o):r.colIndx,k=(r.offset==null)?n.getRowIndxOffset():r.offset,g=r.rowIndxPage=l-k,p=r.evt,q=(n.init+k),j=(n["final"]+k);if(this.isSelected(r)){if(l>=q&&l<=j){var h=n.getCell({rowIndxPage:g,colIndx:i});if(h){h.removeClass("pq-cell-select")}n._trigger("cellUnSelect",p,{rowIndx:l,colIndx:i,dataIndx:o,dataModel:n.dataModel,$td:h})}this._removeFromData(r)}var m=this.indexOf(r);if(m!=-1){this.selectedCells.splice(m,1)}};e.indexOf=function(n){if(this.isDirty){this.refresh()}var m=n.rowIndx,l=this.that,h=n.dataIndx=(n.dataIndx==null)?l.colModel[n.colIndx].dataIndx:n.dataIndx;var g=this.selectedCells;for(var j=0;j<g.length;j++){var k=g[j];if(k.rowIndx==m&&k.dataIndx==h){return j}}return -1};e.getSelection=function(){if(this.isDirty){this.refresh()}return this.selectedCells};var d={};d.options={colModel:null,columnBorders:true,customData:null,dataModel:{curPage:0,totalPages:0,rPP:10,location:"local",sorting:"local",sortDir:"up",method:"GET",rPPOptions:[10,20,50,100]},draggable:false,editable:true,editModel:{clicksToEdit:1,saveKey:""},flexHeight:false,flexWidth:false,freezeCols:0,getDataIndicesFromColIndices:true,height:400,hoverMode:"row",minWidth:50,numberCell:true,numberCellWidth:50,resizable:false,scrollModel:{pace:"fast",horizontal:true},selectionModel:{type:"row",mode:"range"},sortable:true,title:"&nbsp;",topVisible:true,width:600,wrap:true};d._destroyResizable=function(){if(this.element.data("resizable")){this.element.resizable("destroy")}};d._destroyDraggable=function(){if(this.element.data("draggable")){this.element.draggable("destroy")}};d._disable=function(){if(this.$disable==null){this.$disable=f("<div class='pq-grid-disable'></div>").css("opacity",0.2).appendTo(this.element)}};d._enable=function(){if(this.$disable){this.element[0].removeChild(this.$disable[0]);this.$disable=null}};d._destroy=function(){this._destroyResizable();this._destroyDraggable();this.element.empty();this.element.css("height","");this.element.css("width","");this.element.removeClass("pq-grid").removeData()};d._findCellFromEvtCoords=function(r){if(this.$tbl==null){return{$td:null,rowIndxPage:null,colIndx:null}}var q=r.pageY-this.$cont.offset().top;var l=r.pageX-this.$cont.offset().left;var k=this.$tbl.find("tr");var p=0,h=0,m=0;for(var n=1;n<k.length;n++){if(k[n].offsetTop>q){break}else{p++}}var o=f(k[p]);h=parseInt(o.attr("pq-row-indx"));var g=o.find("td");p=0;for(var n=1;n<g.length;n++){if(g[n].offsetLeft>l){break}else{p++}}var j=f(g[p]);if(j[0].nodeName.toUpperCase()!="TD"){j=f(r.target).parent("td")}m=parseInt(j.attr("pq-col-indx"));return{$td:j,rowIndxPage:h,colIndx:m}};d._rangeSelectRow=function(j,m,o){var l=this,n=l.sRows.getSelection(),g=n.slice(0);for(var k=0;k<g.length;k++){var h=g[k],p=h.rowIndx;if(p<j||p>m){l.sRows.remove({rowIndx:p})}}for(var p=j;p<=m;p++){l.sRows.add({rowIndx:rowIndx})}};d._rangeSelect=function(o,l,s,p,t){var q=this,h=q.sCells.getSelection(),k=h.slice(0);for(var n=0;n<k.length;n++){var m=k[n],u=m.rowIndx,r=m.dataIndx,g=this.getColIndxFromDataIndx(r);if(u<o||u>s){q.sCells.remove({rowIndx:u,colIndx:g,dataIndx:r})}else{if(u==o&&g<l){q.sCells.remove({rowIndx:u,colIndx:g,dataIndx:r})}else{if(u==s&&g>p){q.sCells.remove({rowIndx:u,colIndx:g,dataIndx:r})}}}}for(var g=0;g<q.colModel.length;g++){var j=q.colModel[g];if(j.hidden){continue}var r=j.dataIndx;var u=o;do{if(u==o&&g<l){}else{if(u==s&&g>p){break}else{q.sCells.add({rowIndx:u,colIndx:g,dataIndx:r})}}u++}while(u<=s)}};d._blockSelect=function(o,l,s,p,t){var q=this,h=q.sCells.getSelection(),k=h.slice(0);for(var n=0;n<k.length;n++){var m=k[n],u=m.rowIndx,r=m.dataIndx,g=this.getColIndxFromDataIndx(r);if(g<l||g>p){q.sCells.remove({rowIndx:u,dataIndx:r,colIndx:g})}else{if(u<o||u>s){q.sCells.remove({rowIndx:u,dataIndx:r,colIndx:g})}}}for(var g=l;g<=p;g++){var j=q.colModel[g];var r=j.dataIndx;if(j.hidden){continue}var u=o;do{q.sCells.add({rowIndx:u,colIndx:g,dataIndx:r});u++}while(u<=s)}};d._addSelection=function(j){var g=j.rowIndxPage,i=j.colIndx;var h=this.data;h[g][this.customDataIndx]={selection:{colIndx:i}}};d._removeSelection=function(k){var g=k.rowIndxPage,j=k.colIndx,h=k.$tr,i=this.data;i[g][this.customDataIndx]={selection:null}};d._create=function(){this.minWidth=this.options.minWidth;this.cols=[];this.dataModel=this.options.dataModel;this.widths=[];this.outerWidths=[];this.rowHeight=22;this.hidearr=[];this.hidearrHS=[];this.numberCell=this.options.numberCell;this.numberCellWidth=this.options.numberCellWidth;this.freezeCols=this.options.freezeCols;this.columnBorders=this.options.columnBorders;var j=this;this.$tbl=null;this._refreshHeader();this._refreshWidths();this._computeOuterWidths();this.element.empty().addClass("pq-grid").append("<div class='pq-grid-top'>		<div class='pq-grid-title'>&nbsp;</div></div>	<div class='pq-grid-inner' tabindex=0><div class='pq-grid-right'> 		<div class='pq-header-outer'><span class='pq-grid-header'></span><span class='pq-grid-header'></span></div> 		<div class='pq-cont-right' style=''>			<div class='pq-cont' ></div> 		</div> 		</div></div>	<div class='pq-grid-bottom'>	<div class='pq-grid-footer'>&nbsp;</div>	</div>");this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel});this.$top=f("div.pq-grid-top",this.element);this.$title=f("div.pq-grid-title",this.element);this.$toolbar=f("div.pq-grid-toolbar",this.element);this.$grid_inner=f("div.pq-grid-inner",this.element);this.$grid_right=f(".pq-grid-right",this.element);this.$header_o=f("div.pq-header-outer",this.$grid_right);if(!this.options.topVisible){this.$top.css("display","none")}this.$header=f(".pq-grid-header",this.$grid_right);this.$header_left=f(this.$header[0]);this.$header_right=f(this.$header[1]);this.$bottom=f("div.pq-grid-bottom",this.element);this.$footer=f("div.pq-grid-footer",this.element);this.$cont_o=f("div.pq-cont-right",this.$grid_right);this.$cont=f("div.pq-cont",this.$grid_right);this.$cont.on("click",function(l){return j._onClickCont(l)});this.$cont.on("click","td.pq-grid-cell",function(l){return j._onClickCell(l)}).mousedown(function(l){});this.$cont.on("click","tr.pq-grid-row",function(l){return j._onClickRow(l)});this.$cont.on("dblclick","td.pq-grid-cell",function(l){return j._onDblClickCell(l)});this.$cont.on("mouseenter","td.pq-grid-cell",function(l){var m=f(this);if(j._trigger("cellMouseEnter",l,{$td:m,dataModel:j.options.dataModel})==false){return false}if(j.options.hoverMode=="cell"){j.highlightCell(m)}});this.$cont.on("mouseenter","tr.pq-grid-row",function(l){var m=f(this);if(j._trigger("rowMouseEnter",l,{$tr:m,dataModel:j.options.dataModel})==false){return false}if(j.options.hoverMode=="row"){j.highlightRow(m)}});this.$cont.on("mouseleave","td.pq-grid-cell",function(l){var m=f(this);if(j._trigger("cellMouseLeave",l,{$td:m,dataModel:j.options.dataModel})==false){return false}if(j.options.hoverMode=="cell"){j.unHighlightCell(m)}});this.$cont.on("mouseleave","tr.pq-grid-row",function(l){var m=f(this);if(j._trigger("rowMouseLeave",l,{$tr:m,dataModel:j.options.dataModel})==false){return false}if(j.options.hoverMode=="row"){j.unHighlightRow(m)}});this.$cont.bind("mousewheel DOMMouseScroll",function(l){return j._onMouseWheel(l)});var g=0;this.$hvscroll=f("<div class='pq-hvscroll-square'></div>").appendTo(this.$grid_inner);this.$vscroll=f("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner);this.prevVScroll=0;this.$vscroll.pqScrollBar({pace:j.options.scrollModel.pace,direction:"vertical",cur_pos:0,scroll:function(l,n){var m=parseInt(n.cur_pos);if(j.init!=m){j.scrollMode=true;f.measureTime(function(){j.selectCellRowCallback(j._generateTables)},"that.selectCellRowCallback(that._generateTables)")}if(l.originalEvent&&l.originalEvent.type=="drag"){j._setVScrollNumEles()}else{j._setVScrollNumEles(true)}}});var i=0;this.$hscroll=f("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner);this.$hscroll.pqScrollBar({direction:"horizontal",pace:j.options.scrollModel.pace,cur_pos:0,scroll:function(l,m){j._bufferObj_calcInitFinalH();j._refreshHideArrHS();j.scrollMode=true;j.selectCellRowCallback(function(){j._createHeader();j._refreshHeaderSortIcons();j._generateTables()})}});this.element.width(this.options.width+"px").height(this.options.height+"px");this.disableSelection();if(window.opera){this.$grid_inner.bind("keypress.pq-grid",{that:this},function(l){j.keyPressDown(l)})}else{this.$grid_inner.bind("keydown.pq-grid",{that:this},function(l){j.keyPressDown(l)})}this._refreshOptions();this._refreshTitle();var h=this.options.dataModel;if(typeof h.sortIndx=="number"&&h.sorting=="local"&&h.location=="local"){this._refreshDataIndices();var k=this.getColIndxFromDataIndx(h.sortIndx);this._sortLocalData(h.sortIndx,h.sortDir,this.colModel[k].dataType,h.data)}this._initData();this._createSelectedRowsObject();this._createSelectedCellsObject();this._refresh()};d._onMouseWheel=function(h){var k=this;var j=0;var h=h.originalEvent;if(h.wheelDelta){j=h.wheelDelta/120}else{if(h.detail){j=h.detail*-1/3}}var i=parseInt(k.$vscroll.pqScrollBar("option","cur_pos"));var g=i-j;if(g>=0){k.$vscroll.pqScrollBar("option","cur_pos",i-j).pqScrollBar("scroll")}return false};d._onDblClickCell=function(h){var j=this;var n=f(h.currentTarget);var l=j.getCellIndices(n);var g=l.rowIndxPage,m=j.getRowIndxOffset(),i=g+m,k=l.colIndx;if(j._trigger("cellDblClick",h,{$td:n,dataModel:j.options.dataModel})==false){return false}if(this.isEditableCell({colIndx:k})&&j.options.editModel.clicksToEdit>1){j._setSelection(null);if(j.options.selectionModel.type=="cell"){j._setSelection({rowIndx:i,colIndx:k})}else{if(j.options.selectionModel.type=="row"){j._setSelection({rowIndx:i})}}j._editCell(n)}};d._onClickCont=function(g){var h=this;if(h.$td_edit){if(!h._isEditCell(g)){h.quitEditMode(g)}}};d._onClickRow=function(v){var s=this;var r=f(v.currentTarget);var g=parseInt(r.attr("pq-row-indx")),m=s.getRowIndxOffset(),n=g+m;var x={rowIndx:n,evt:v};if(s._trigger("rowClick",v,{$tr:r,rowIndx:n,dataModel:s.options.dataModel})==false){return false}var h=s.options.selectionModel;if(h.type=="row"){var u=s.sRows.getSelection();if(u.length>0){if(v.ctrlKey&&h.mode!="single"){if(s.sRows.indexOf(x)!=-1){s.sRows.remove(x)}else{s._setSelection(x)}}else{if(v.shiftKey&&h.mode!="single"){var l=u[u.length-1],j=l.rowIndx,p=j,t=n;if(j>n){p=n;t=j}var k=u.slice(0);for(var o=0;o<k.length;o++){var q=k[o],w=q.rowIndx;if(w<p||w>t){s.sRows.remove({rowIndx:w,evt:v})}}for(var w=p;w<=t;w++){s.sRows.add({rowIndx:w,evt:v})}s._setSelection(x)}else{s.sRows.removeAll({raiseEvent:true});s._setSelection(x)}}}else{s._setSelection(x)}}};d.isEditableCell=function(j){var i=j.colIndx,h=(j.column==null)?(this.colModel[i]):j.column,g=true;if(this.options.editable==false){g=false}if(h.editable==false){g=false}return g};d._onClickCell=function(r){var l=this,o=this.options,v=o.selectionModel;var k=f(r.currentTarget);var h=l.getCellIndices(k);var g=h.rowIndxPage,j=l.getRowIndxOffset(),m=h.rowIndx=g+j,u=h.colIndx,q=h.dataIndx=this.colModel[u].dataIndx,i=l.colModel[u];h.evt=r;if(l._trigger("cellClick",r,{$td:k,rowIndx:m,colIndx:u,dataIndx:q,column:i,dataModel:l.options.dataModel})==false){return false}if(l.$td_edit){l.quitEditMode(r)}if(this.isEditableCell({column:i})&&o.editModel.clicksToEdit=="1"){l._setSelection(null);if(v.type=="cell"){l._setSelection(h)}else{l._bringRowIntoView({rowIndxPage:g});k=l._bringCellIntoView({rowIndxPage:g,colIndx:u})}window.setTimeout(function(){l.editCell(h)},0);return}if(v.type=="cell"){var p=l.sCells.getSelection();if(p.length>0){if(r.ctrlKey&&v.mode!="single"){if(l.sCells.isSelected(h)){l.sCells.remove(h)}else{l._setSelection(h)}}else{if(r.shiftKey&&v.mode!="single"){var y=p[p.length-1],n=y.rowIndx,t=l.getColIndxFromDataIndx(y.dataIndx),s=n,x=m,w=t,z=u;if(n>m){s=m;x=n}if(l.options.selectionModel.mode=="range"){if(n>m){w=u;z=t}if(m==n&&u<t){w=u;z=t}l._rangeSelect(s,w,x,z,r)}else{if(l.options.selectionModel.mode=="block"){if(t>u){w=u;z=t}l._blockSelect(s,w,x,z,r)}}l._setSelection(h)}else{l.sCells.removeAll({raiseEvent:true});l._setSelection(h)}}}else{l._setSelection(h)}}};d.highlightCell=function(g){g.addClass("pq-grid-cell-hover")};d.unHighlightCell=function(g){g.removeClass("pq-grid-cell-hover")};d.highlightRow=function(g){g.addClass("pq-grid-row-hover")};d.unHighlightRow=function(g){g.removeClass("pq-grid-row-hover")};d._createSelectedRowsObject=function(){this.sRows=new c(this)};d._createSelectedCellsObject=function(){this.sCells=new a(this)};d._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.data,colModel:this.options.colModel}};d._refreshOptions=function(){this._refreshDataOptions()};d._refreshDataOptions=function(){};d.enableSelection=function(){this.$grid_inner.enableSelection()};d.disableSelection=function(){this.$grid_inner.disableSelection()};d._isEditCell=function(i){var g=f(i.target);var h=g.closest("div.pq-cell-selected-border-edit");if(h&&h.length>0){return true}return false};d._findCellFromEvt=function(h){var g=f(h.target);var j=g.closest(".pq-grid-cell");if(j==null||j.length==0){return{rowIndxPage:null,colIndx:null,$td:null}}else{var i=this.getCellIndices(j);i.$td=j;return i}};d._initPager=function(){var g=this.options.dataModel;var h=this;var i={rPP:g.rPP,rPPOptions:g.rPPOptions,change:function(j,l){var k=h.options.dataModel;if(l.curPage!=undefined){k.prevPage=k.curPage;k.curPage=l.curPage}if(l.rPP!=undefined){k.rPP=l.rPP}if(k.paging=="remote"){h.remoteRequest()}else{h.$td_edit=null;h._refreshDataFromDataModel();h._refresh()}},refresh:function(j){h.refreshDataAndView()}};if(g.paging){this.$footer.pqPager(i)}else{}};d._initData=function(){var h=this;var g=this.options.dataModel;if(g==undefined){throw ("dataModel not found.")}this._initPager();if(g.location=="remote"){var h=this;this.generateLoading();this.remoteRequest()}else{this._refreshDataFromDataModel()}};d._refreshHideArrHS=function(){var j=this;for(var g=0;g<j.colModel.length;g++){j.hidearrHS[g]=false}if(j.initH>0){var h=j.freezeCols-1+j.initH;for(var g=j.freezeCols;g<=h;g++){if(j.colModel[g].hidden){continue}j.hidearrHS[g]=true}}else{}};d.generateLoading=function(){var g=f("<div class='pq-loading'></div>").appendTo(this.element);f("<div class='pq-loading-bg'></div><div class='pq-mask'><div>Loading...</div></div>").appendTo(g);g.find("div.pq-loading-bg").css("opacity",0.2)};d.showLoading=function(){this.element.find("div.pq-loading").show()};d.hideLoading=function(){this.element.find("div.pq-loading").hide()};d._refreshDataFromDataModel=function(){var m=this.options,q=m.dataModel,o=m.groupModel,l=(o&&o.grouping=="local")?true:false;if(q.data==null||q.data.length==0){if(q.paging){q.curPage=0;q.totalPages=0;q.totalRecords=0}return}if(q.paging&&q.paging=="local"){q.totalRecords=q.data.length;q.totalPages=Math.ceil(q.data.length/q.rPP);if(q.curPage>q.totalPages){q.curPage=q.totalPages}if(q.curPage<1&&q.totalPages>0){q.curPage=1}var p=(q.curPage-1)*q.rPP;var n=q.curPage*q.rPP;if(n>q.data.length){n=q.data.length}if(l){this._groupArrays();var g=this.dataGM;for(var j=0,k=g.length;j<k;j++){var h=g[j].rowIndx;if(h==p){if(g[j-1].rowIndx==null){p=j-1}else{p=j}}else{if(h==n){if(g[j+1].rowIndx==null){n=j+1}else{n=j}}}}this.data=this.dataGM.slice(p,n)}else{this.data=q.data.slice(p,n)}}else{if(l){this._groupArrays();this.data=this.dataGM}else{this.data=q.data}}};d.remoteRequest=function(l){if(this.loading){this.xhr.abort()}var i=this;var h="";var k="";var g=this.options.dataModel;if(typeof g.getUrl=="function"){var j=g.getUrl();if(j&&j.url){h=j.url}if(j&&j.data){k=j.data}}if(!h){return}this.loading=true;this.showLoading();this.xhr=f.ajax({url:h,dataType:g.dataType,async:true,cache:false,type:g.method,data:k,beforeSend:function(n,m){if(typeof g.beforeSend=="function"){return g.beforeSend(n,m)}},success:function(m,q,o){var n=false;if(typeof g.getData=="function"){var p=g.getData(m,q,o);g.data=p.data;if(g.paging){if(g.paging=="remote"){if(p.curPage){g.curPage=p.curPage}if(p.totalRecords){g.totalRecords=p.totalRecords;g.totalPages=Math.ceil(g.totalRecords/g.rPP)}}}i._refreshDataFromDataModel();if(g.sorting=="local"&&g.sortIndx!=undefined){i._refreshSortingDataAndView({sorting:true})}else{i._refreshViewAfterDataSort()}}else{throw ("getData callback not found!")}i.hideLoading();i.loading=false;i._trigger("load",null,{dataModel:i.options.dataModel,data:i.data});if(typeof l=="function"){l()}},error:function(m,o,n){i.hideLoading();i.loading=false;if(typeof g.error=="function"){g.error(m,o,n)}}})};d._fixFireFoxContentEditableIssue=function(){if(window.postMessage){this.$grid_inner.focus()}};d.selectCellRowCallback=function(g){var i,j;if(this.$td_edit){this.quitEditMode()}var h=this;f.measureTime(function(){g.call(h)},"_generateTables");if(this.options.flexHeight){this._setGridHeightFromTable()}if(this.options.flexWidth){this._setGridWidthFromTable()}};d._refreshTitle=function(){this.$title.html(this.options.title)};d._refreshDraggable=function(){if(this.options.draggable){this.$title.addClass("draggable");this.element.draggable({handle:this.$title,start:function(g,h){}})}else{this._destroyDraggable()}};d._refreshResizable=function(){var g=this;if(this.options.resizable){this.element.resizable({helper:"ui-state-highlight",delay:0,start:function(h,i){f(i.helper).css({opacity:0.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(h,i){},stop:function(h,i){g.options.height=g.element.height();g.options.width=g.element.width();g._refresh();g.element.css("position","relative")}})}else{this._destroyResizable()}};d.refresh=function(){this._refresh()};d._refreshDataIndices=function(){if(this.options.getDataIndicesFromColIndices==false){return}var g=this.colModel;for(var h=0;h<g.length;h++){var j=g[h];if(j.dataIndx==null){j.dataIndx=h}}};d._refresh=function(){var g=this;this._refreshDataIndices();this._refreshResizable();this._refreshDraggable();this._bufferObj_calcInitFinalH();this._refreshHideArrHS();this._computeOuterWidths(true);this._createHeader();this._refreshHeaderSortIcons();this._setInnerGridHeight();this._setRightGridHeight();this.selectCellRowCallback(function(){g._generateTables();g._computeOuterWidths()});this._setVScrollHeight();this._setHScrollWidth();this._refreshPager()};d._refreshPager=function(){var g=this.options.dataModel;if(g.paging){this.$footer.pqPager("option",{currentPage:g.curPage,totalPages:g.totalPages,totalRecords:g.totalRecords,rPP:g.rPP,rPPOptions:g.rPPOptions})}};d._refreshViewAfterDataSort=function(){this.selectCellRowCallback(function(){this._generateTables();this._computeOuterWidths()});this._refreshHeaderSortIcons();this._setRightGridHeight();this._setVScrollHeight();this._setHScrollWidth();this._refreshPager()};d.refreshSortingDataAndView=function(){this._refreshSortingDataAndView({sorting:true})};d.refreshDataAndView=function(h){this.data=null;this.sRows.setDirty();this.sCells.setDirty();var g=this.options.dataModel;if(g.location=="remote"){g.data=null;this.remoteRequest()}else{this._refreshSortingDataAndView({keepSelection:h})}};d.getColIndxFromDataIndx=function(h){var g=this.colModel;for(var j=0;j<g.length;j++){if(g[j].dataIndx==h){return j}}};d._refreshSortingDataAndView=function(k){var l=k.sorting,o=k.fn,g=k.keepSelection;if(!g){this.sRows.removeAll({raiseEvent:true});this.sCells.removeAll({raiseEvent:true})}var q=this.options.dataModel,r=this.colModel,m=q.sortIndx,i=this.getColIndxFromDataIndx(m);var h=q.sortDir;var n=this;if(l==true){if(m==null||i==null){return}if(q.sorting=="remote"){this.remoteRequest(o)}else{var j=r[i];var p=j.dataType;this._sortLocalData(m,h,p,q.data);this.sRows.setDirty();this.sCells.setDirty();this._refreshDataFromDataModel();n._refreshViewAfterDataSort();if(typeof o=="function"){o()}}}else{if(q.location=="remote"){this.remoteRequest(o)}else{if(this.data==null){this._refreshDataFromDataModel()}n._refreshViewAfterDataSort();if(typeof o=="function"){o()}}}};d._computeOuterWidths=function(j){var h=this.options,l=h.columnBorders,g=this.colModel,n=g.length;for(var k=0;k<n;k++){var m=g[k];this.outerWidths[k]=parseInt(m.width)+((l)?1:0)}this.numberCell_outerWidth=this.numberCellWidth+1;return};d._setOption=function(g,h){this.refreshRequired=true;if(g=="height"){this.element.height(h+"px");f.Widget.prototype._setOption.call(this,g,h)}else{if(g=="width"){this.element.width(h+"px");f.Widget.prototype._setOption.call(this,g,h)}else{if(g=="title"){f.Widget.prototype._setOption.call(this,g,h);this._refreshTitle()}else{if(g=="freezeCols"){if(!isNaN(h)&&h>=0&&parseInt(h)<=this.colModel.length-2){this.options.freezeCols=this.freezeCols=parseInt(h);this._refreshFreezeLine();this._setHScrollWidth();f.Widget.prototype._setOption.call(this,g,h)}}else{if(g=="resizable"){f.Widget.prototype._setOption.call(this,g,h)}else{if(g=="scrollModel"){var i=h;for(var g in i){this.options.scrollModel[g]=i[g]}}else{if(g=="dataModel"){f.Widget.prototype._setOption.call(this,g,h);this.refreshDataAndView(true);this.refreshRequired=false}else{if(g=="selectionModel"){var i=h;for(var g in i){this.options.selectionModel[g]=i[g]}this.refreshRequired=false}else{if(g=="colModel"){f.Widget.prototype._setOption.call(this,g,h);this._refreshHeader();this._refreshWidths();this._refreshDataIndices()}else{if(g=="disabled"){if(h==true){this._disable()}else{this._enable()}this.refreshRequired=false}else{if(g=="customData"){f.Widget.prototype._setOption.call(this,g,h);this.refreshRequired=false}else{f.Widget.prototype._setOption.call(this,g,h)}}}}}}}}}}}};d._setOptions=function(){f.Widget.prototype._setOptions.apply(this,arguments);if(this.refreshRequired){this._refresh()}this.refreshRequired=true};d._generateCellRowOutline=function(j){var h=j.$td,k=j.$tr,l=this;if(k){var i=l._calcRightEdgeCol(l.colModel.length-1);i-=4;var n=k[0].offsetHeight-4;var o=f(k[0].offsetParent);var g=o[0].offsetParent;var p=k[0].offsetLeft+o[0].offsetLeft;var m=k[0].offsetTop+o[0].offsetTop;l._generateCellHighlighter(g,p,m,i,n)}else{if(h){var o=f(h[0].offsetParent);var g=o[0].offsetParent;var i=h[0].offsetWidth-4;var n=h[0].offsetHeight-4;var p=h[0].offsetLeft+o[0].offsetLeft;var m=h[0].offsetTop+o[0].offsetTop;l._generateCellHighlighter(g,p,m,i,n)}}};d._removeCellRowOutline=function(){if(this.$div_focus){this._fixFireFoxContentEditableIssue();this.$div_focus.remove();this.$div_focus=null}};d._generateCellHighlighter=function(i,j,k,h,g){if(this.$div_focus&&this.$div_focus[0].offsetParent==i){if(this.$td_edit!=null){this._fixFireFoxContentEditableIssue();this.$div_focus.empty().removeClass("pq-cell-selected-border-edit");this.$td_edit=null}this.$div_focus.css({left:j,top:k,height:g,width:h})}else{if(this.$div_focus){this.$div_focus.remove()}this.$div_focus=f("<div class='pq-cell-selected-border'></div>").appendTo(i);this.$div_focus.css({left:j,top:k,height:g,width:h})}};d._selectRow=function(h,g){this.selectRow(h,g)};d._findfirstUnhiddenColIndx=function(){for(var g=0;g<this.colModel.length;g++){if(!this.colModel[g].hidden){return g}}};d.selectRow=function(i){var h=i.rowIndx,g=i.evt,j=i.offset;if(g&&(g.type=="keydown"||g.type=="keypress")){if(this.sRows.replace(i)==false){return false}}else{if(this.sRows.add(i)==false){return false}}if(g!=null){this._setGridFocus()}return true};d.scrollY=function(g){this.$vscroll.pqScrollBar("option","cur_pos",g).pqScrollBar("scroll")};d._bringRowIntoView=function(k){var g=k.rowIndxPage;var r=this.init-this.offsetRow;if(g<r){this.$vscroll.pqScrollBar("option","cur_pos",(g+this.offsetRow)).pqScrollBar("scroll")}var m=this.$tbl.find("tr[pq-row-indx="+g+"]");if(m[0]==undefined){this.$vscroll.pqScrollBar("option","cur_pos",(g+this.offsetRow)).pqScrollBar("scroll")}else{var q=m[0].offsetTop+m[0].offsetHeight,i=this.$cont[0].offsetHeight,j=this._getScollBarHorizontalHeight();if(q>i-j){var p=q-(i-j);var h=this.$tbl.children().children("tr");var o=0,l=0;h.each(function(t,u){o+=u.offsetHeight;if(o>=p){l=t;return false}});l--;var n=this.init+l+1;if(n>g){l=g-1-this.init}var s=this.$vscroll.pqScrollBar("option","num_eles");if(s<n+1){s=n+1}this.$vscroll.pqScrollBar("option",{num_eles:s,cur_pos:n}).pqScrollBar("scroll")}}};d._bringCellIntoView=function(q){var h=q.rowIndxPage,m=q.colIndx,n=false;var j;if(this.hidearrHS[m]){this.hidearrHS[m]=false;var s=m-this.freezeCols-this._calcNumHiddenUnFrozens(m);this.$hscroll.pqScrollBar("option","cur_pos",s).pqScrollBar("scroll");n=true}else{var j=this.$tbl.find("tr[pq-row-indx="+h+"]>td[pq-col-indx="+m+"]");if(j.length==0){return false}var o=this._calcRightEdgeCol(m).width;var u=17;if(this.$vscroll.css("visibility")=="hidden"||this.$vscroll.css("display")=="none"){u=0}if(o>this.$cont[0].offsetWidth-u){var t=this._calcWidthCols(m)-(this.$cont[0].offsetWidth-u);var g=j.parent("tr").children("td");var k=this.colModel.length;var l=0,r=0;for(var p=this.freezeCols;p<k;p++){if(!this.colModel[p].hidden){l+=this.outerWidths[p]}if(p==m){r=p-this.freezeCols-this._calcNumHiddenUnFrozens(p);break}else{if(l>=t){r=p-this.freezeCols-this._calcNumHiddenUnFrozens(p)+1;break}}}this.$hscroll.pqScrollBar("option","cur_pos",r).pqScrollBar("scroll");n=true}}if(n){var j=this.$tbl.find("tr[pq-row-indx="+h+"]>td[pq-col-indx="+m+"]");return j}else{return j}};d.selection=function(j){var h=j.rowIndx,i=j.colIndx,k=j.method,g=j.type;if(g=="row"){return this["sRows"][k](j)}else{if(g=="cell"){return this["sCells"][k](j)}}return};d.setSelection=function(g){if(g==null||g.rowIndx==null){this.sRows.removeAll({raiseEvent:true});this.sCells.removeAll({raiseEvent:true});return}this._bringPageIntoView(g);return this._setSelection(g)};d._bringPageIntoView=function(n){var l=n.rowIndx,k=this;var h=this.options.dataModel;if(h.paging=="local"&&l>=0){var j=h.curPage;var m=h.rPP;var i=(j-1)*m;var g=j*m;if(l>=i&&l<g){}else{h.curPage=Math.ceil((l+1)/m);this.refreshDataAndView(true);f.measureTime(function(){k.selectCellRowCallback(k._generateTables)},"that.selectCellRowCallback(that._generateTables)")}rowIndxPage=(l%m)}};d._setSelection=function(k){if(k==null){this.sRows.removeAll({raiseEvent:true});this.sCells.removeAll({raiseEvent:true});return false}var l=k.offset=(k.offset==null)?this.getRowIndxOffset():k.offset,i=k.rowIndx=(k.rowIndx==null)?k.rowIndxPage+l:k.rowIndx,g=k.rowIndxPage=(k.rowIndxPage==null)?k.rowIndx-l:k.rowIndxPage,j=k.colIndx,h=k.evt;if(g<0||j<0){return false}if(this.data==null||this.data.length==0){return false}if(g>=this.data.length||j>=this.colModel.length){return false}this._bringRowIntoView({rowIndxPage:g});if(j==null){return this.selectRow({rowIndx:i,evt:h})}this._bringCellIntoView({rowIndxPage:g,colIndx:j});return this.selectCell({rowIndx:i,colIndx:j,evt:h})};d.saveEditCell=function(){if(this.$td_edit==null){return}var h=this.$td_edit,n=this.getCellIndices(h),l=this.getRowIndxOffset(),i=n.colIndx,g=n.rowIndxPage,m=n.rowIndx=g+l,r=this.colModel,j=n.column=r[i],p=n.dataIndx=j.dataIndx,k=this.data[g][p];if(g!=null){var q=this._getEditCellData(n);if(q!=k){this.data[g][p]=q;n.data=this.data;if(this._trigger("cellSave",null,n)==false){return}this.refreshRow(n);this._fixTableViewPort();var o=this;if(o.options.flexHeight){o._setGridHeightFromTable();o._fixIEFooterIssue()}else{o._bringRowIntoView({rowIndxPage:g})}}}};d._fixTableViewPort=function(){var g=this.$cont[0];g.scrollTop=0;g.style.marginTop="-1px";g.scrollLeft=0};d._fixIEFooterIssue=function(){f(".pq-grid-footer").css({position:"absolute"});f(".pq-grid-footer").css({position:"relative"})};d.refreshColumn=function(j){var i=j.colIndx=(j.colIndx==null)?this.getColIndxFromDataIndx(j.dataIndx):j.colIndx,l=this.getRowIndxOffset();for(var k=this.init;k<=this["final"];k++){var g=j.rowIndxPage=k;j.rowIndx=g+l;var h=j.column=this.colModel[i];j.$td=this.getCell(j);j.rowData=this.data[g];this._renderCell(j)}};d.refreshCell=function(n){var l=n.offset=(n.offset==null)?this.getRowIndxOffset():n.offset,m=n.rowIndx=(n.rowIndx==null)?n.rowIndxPage+l:n.rowIndx,g=n.rowIndxPage=(n.rowIndxPage==null)?n.rowIndx-l:n.rowIndxPage,o=n.dataIndx,i=n.colIndx=(n.colIndx==null)?this.getColIndxFromDataIndx(o):n.colIndx,h=n.$td=(n.$td==null)?this.getCell(n):n.$td,j=n.column=this.colModel[i];var k=n;k.rowData=this.data[g];if(h&&h.length>0){this._renderCell(k)}};d.refreshRow=function(n){var l=n.offset=(n.offset==null)?this.getRowIndxOffset():n.offset,m=n.rowIndx=(n.rowIndx==null)?n.rowIndxPage+l:n.rowIndx,g=n.rowIndxPage=(n.rowIndxPage==null)?n.rowIndx-l:n.rowIndxPage,o=(n.$tr==null)?this.getRow(n):n.$tr,p=this.colModel;var k={rowIndx:m,rowIndxPage:g,rowData:this.data[g]};for(var i=0;i<p.length;i++){var j=p[i];var h=o.find("td[pq-col-indx="+i+"]");k.$td=h;k.colIndx=i;k.column=j;if(h&&h.length>0){this._renderCell(k)}}};d.quitEditMode=function(g){if(this.$td_edit){var h=this.$td_edit;this.disableSelection();this._setGridFocus();this._trigger("quitEditMode",g,{$td:h,dataModel:this.options.dataModel});this._removeCellRowOutline();this.$td_edit=null}};d.getData=function(){return this.data};d.getViewPortRowsIndx=function(){return{beginIndx:this.init,endIndx:this["final"]}};d.getRowIndxOffset=function(){var h=this.options.dataModel,g=h.paging,k=0;if(g=="local"||g=="remote"){var i=h.curPage;var j=h.rPP;k=(j*(i-1))}return k};d.getRowOffset=function(){return this.offsetRow};d._cellblurred=function(){this.$div_focus.remove();this.$div_focus=null;this.$td_focus=null;this.$tr_focus=null};d.selectCell=function(j){var h=j.rowIndx,i=j.colIndx,g=j.evt;if(g&&(g.type=="keydown"||g.type=="keypress")){if(this.sCells.replace(j)==false){return false}}else{if(this.sCells.add(j)==false){return false}}if(g!=null){this._setGridFocus()}return true};d._setGridFocus=function(){var g=this;window.setTimeout(function(){if(g.$td_edit==null){g.$grid_inner.focus()}},0)};d.getEditCell=function(){if(this.$td_edit){return $td_edit}else{return false}};d.editCell=function(g){var h=this.getCell(g);if(h!=null&&h.length==1){if(this.$td_edit&&this.$td_edit[0]!=h[0]){this.quitEditMode()}this._editCell(h);return h}};d.getFirstEditableColIndx=function(){if(!this.options.editable){return -1}var g=this.colModel;for(var h=0;h<g.length;h++){var j=g[h];if(j.editable==false){continue}return h}return -1};d._editFirstCellInRow=function(i){var h=this.getFirstEditableColIndx();if(h!=-1){var g=i.rowIndxPage;i.colIndx=h;this._bringRowIntoView(i);var j=this._bringCellIntoView(i);if(j&&j.length>0){this._editCell(j)}}};d._editCell=function(h){var n=this;var m=n.getCellIndices(h);var g=m.rowIndxPage,k=this.getRowIndxOffset(),l=g+k,i=m.colIndx,j=this.colModel[i],o=j.dataIndx;if(this.$td_edit&&this.$td_edit[0]==h[0]){return false}this.$td_edit=h;this.enableSelection();this._removeCellRowOutline();this._generateCellRowOutline({$td:h});var p=this.$div_focus.addClass("pq-cell-selected-border-edit");if(j.align=="right"){p.css("text-align","right")}else{if(j.align=="center"){p.css("text-align","center")}else{p.css("text-align","left")}}if(j.editor){j.editor({$cell:p,data:this.data,dataModel:this.dataModel,rowIndx:l,rowIndxPage:g,colIndx:o})}else{p.html("<div contenteditable='true' tabindx='0' style='background:#fff;padding:2px;'></div>");var n=this;p.children().html(n.data[g][o])}var n=this;window.setTimeout(function(){if(n.$td_edit!=null){var q=n.$div_focus;q.children().focus()}},0)};d.getRow=function(i){var g=i.rowIndxPage;var h;if(this.$tbl!=undefined){h=this.$tbl.find("tr[pq-row-indx="+g+"]")}return h};d.getCell=function(i){var g=(i.rowIndxPage==null)?(i.rowIndx-this.getRowIndxOffset()):i.rowIndxPage,h=i.colIndx;var j;if(this.$tbl!=undefined){j=this.$tbl.find("tr[pq-row-indx="+g+"]>td[pq-col-indx="+h+"]")}return j};d.getEditCellData=function(){if(this.$td_edit){var g=this.getCellIndices(this.$td_edit);return this._getEditCellData(g)}else{return null}};d._getEditCellData=function(m){var l=m.colIndx,g=m.rowIndxPage,i=(m.rowIndx!=null)?m.rowIndx:g+this.getRowIndxOffset(),h=(m.column)?m.column:this.colModel[l],j=(m.$cell)?m.$cell:this.$div_focus;if(h.getEditCellData){var k=h.getEditCellData({$cell:j,data:this.data,dataIndx:h.dataIndx,dataModel:this.dataModel,rowIndx:i,rowIndxPage:g,colIndx:l})}else{var k=j.children().html()}return k};d.getCellIndices=function(j){if(j==null||j.length==0){return{rowIndxPage:null,colIndx:null}}var h=j.parent("tr");var k=h.parent("tbody");var g=parseInt(h.attr("pq-row-indx"));var i=parseInt(j.attr("pq-col-indx"));return{rowIndxPage:g,colIndx:i}};d._incrIndx=function(g,j){var i=this;if(j==null){if(g==i.data.length-1){return null}g++;return{rowIndxPage:g}}var h;do{j++;if(j>=i.colModel.length){if(g==i.data.length-1){return null}g++;j=0}h=i.colModel[j]}while(h&&h.hidden);return{rowIndxPage:g,colIndx:j}};d._decrIndx=function(g,j){var i=this;if(j==null){if(g==0){return null}g--;return{rowIndxPage:g}}var h;do{j--;if(j<0){if(g==0){return null}g--;j=i.colModel.length-1}h=i.colModel[j]}while(h&&h.hidden);return{rowIndxPage:g,colIndx:j}};d._incrEditIndx=function(g,j){var i=this;var h;do{j++;if(j>=i.colModel.length){if(g==i.data.length-1){return null}g++;j=0}h=i.colModel[j]}while(h&&(h.hidden||h.editable===false));return{rowIndxPage:g,colIndx:j}};d._decrEditIndx=function(g,j){var i=this;var h;do{j--;if(j<0){if(g==0){return null}g--;j=i.colModel.length-1}h=i.colModel[j]}while(h&&(h.hidden||h.editable===false));return{rowIndxPage:g,colIndx:j}};d.keyPressDown=function(w){var r=this,u=this.sCells.getSelection(),m=this.sRows.getSelection(),n=r.getRowIndxOffset(),i=r.options.selectionModel,o,j;var t={left:37,up:38,right:39,down:40,tab:9,enter:13,pageDown:34,pageUp:33,spaceBar:32,esc:27,home:36,end:35};if(r.$td_edit){var h=f(r.$td_edit[0]);var p=r.getCellIndices(h),g=p.rowIndxPage,o=g+n,j=p.colIndx,l=this.colModel[j],k=(l.editModel)?l.editModel.saveKey:null;if(w.keyCode==t.tab){var p;if(w.shiftKey){p=r._decrEditIndx(g,j)}else{p=r._incrEditIndx(g,j)}if(p==null){w.preventDefault();return false}r.saveEditCell();r.quitEditMode(w);if(this.options.selectionModel.type=="row"){if(p.rowIndxPage!=g){r._setSelection(null);r._setSelection({rowIndxPage:p.rowIndxPage})}r._bringCellIntoView({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx})}else{if((p.rowIndxPage!=g||p.colIndx!=j)&&this.options.selectionModel.type=="cell"){r._setSelection(null);r._setSelection({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx})}}g=p.rowIndxPage;j=p.colIndx;var v=this.getCell({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx});this._editCell(v);w.preventDefault();return false}else{if(w.keyCode==k){r.saveEditCell();r.quitEditMode(w)}else{if(k==null&&w.keyCode==this.options.editModel.saveKey){r.saveEditCell();r.quitEditMode(w)}else{if(w.keyCode==t.esc){r.quitEditMode(w);w.preventDefault();return false}else{if(w.keyCode==t.pageUp||w.keyCode==t.pageDown){w.preventDefault();return false}}}}}return}else{if(m.length>0&&i.type=="row"){var p=m[m.length-1],o=p.rowIndx,g=o-n}else{if(u.length>0&&i.type=="cell"){var p=u[u.length-1],o=p.rowIndx,g=o-n,s=p.dataIndx,j=this.getColIndxFromDataIndx(s);if(o==null||j==null){return}r._trigger("cellKeydown",w,{dataModel:this.dataModel,rowIndx:o,colIndx:j,$td:p.$td,column:r.colModel[j]});if(w.cancelBubble){return}}else{return}}}if(w.keyCode==t.left){var p=r._decrIndx(g,j);if(p){r._setSelection({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx,evt:w})}w.preventDefault();return}else{if(w.keyCode==t.right){var p=r._incrIndx(g,j);if(p){r._setSelection({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx,evt:w})}w.preventDefault();return}else{if(w.keyCode==t.tab){var p;if(w.shiftKey){p=r._decrIndx(g,j)}else{p=r._incrIndx(g,j)}if(p){r._setSelection({rowIndxPage:p.rowIndxPage,colIndx:p.colIndx,evt:w})}w.preventDefault();return}else{if(w.keyCode==t.up){o=(g>0)?o-1:o;r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.down){o=(g<r.data.length-1)?(o+1):o;r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.pageDown||w.keyCode==t.spaceBar){g=g+10;if(g>r.data.length-1){g=r.data.length-1}var o=g+n;r.$vscroll.pqScrollBar("option","cur_pos",o).pqScrollBar("scroll");r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.pageUp){g=g-10;if(g<0){g=0}var o=g+n;r.$vscroll.pqScrollBar("option","cur_pos",o).pqScrollBar("scroll");r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.home){o=0+n;r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.end){o=r.data.length-1+n;r._setSelection({rowIndx:o,colIndx:j,evt:w});w.preventDefault();return}else{if(w.keyCode==t.enter){if(this.options.selectionModel.type=="row"){var q,h;if(m.length>0){r._editFirstCellInRow({rowIndxPage:g})}}else{if(u.length>0){var h=this.getCell({rowIndxPage:g,colIndx:j});if(h&&h.length>0){if(this.isEditableCell({colIndx:j})){r._editCell(h)}}}}w.preventDefault();return}else{}}}}}}}}}}};d._calcNumHiddenFrozens=function(){var g=0;for(var h=0;h<this.freezeCols;h++){if(this.colModel[h].hidden){g++}}return g};d._calcNumHiddenUnFrozens=function(k){var h=0;var g=(k!=null)?k:this.colModel.length;for(var j=this.freezeCols;j<g;j++){if(this.colModel[j].hidden){h++}}return h};d._setHScrollWidth=function(){if(!this.options.scrollModel.horizontal){this.$hscroll.css("visibility","hidden");this.$hvscroll.css("visibility","hidden");return}var h=this.$cont[0].offsetWidth;if(this.numberCell){h-=this.numberCell_outerWidth}for(var g=0;g<this.freezeCols;g++){h-=this.outerWidths[g]}var j=0;if(this.$vscroll.css("display")=="none"||this.$vscroll.css("visibility")=="hidden"){this.$hscroll.css("right",0)}else{j=17;this.$hscroll.css("right","")}h-=j;this.$hscroll.pqScrollBar("option","length",h);var k=this.colModel.length-this.freezeCols-this._calcNumHiddenUnFrozens();this.$hscroll.pqScrollBar("option","num_eles",(k))};d._getScollBarHorizontalHeight=function(){var g=17;if(this.$hscroll.css("visibility")=="hidden"||this.options.scrollModel.horizontal==false){g=0}return g};d._setVScrollNumEles=function(r){var o=this,m=this.$vscroll,u=m.pqScrollBar("option"),t=parseInt(u.num_eles),p=parseInt(u.cur_pos);var l=this._getScollBarHorizontalHeight();var s=this.options.groupModel;var n=(s&&s.grouping=="local")?this.dataGM:this.data;var k=n?n.length:0;var j=this.$cont[0].offsetHeight;var i=this.$tbl[0].offsetHeight;if(i>j-l){var h=this.$tbl.children().children("tr");var q=0,g=0;h.each(function(v,w){q+=w.offsetHeight;if(q>=j-l){g=(v>1)?(v-1):0;return false}});t=k-g+1}else{t=this.init+1}if(t<this.init+1){t=this.init+1}if(r){o.$vscroll.pqScrollBar("option","num_eles",t)}else{o.$vscroll.pqScrollBar("setNumEles",t)}};d._setVScrollHeight=function(){var m=this.$cont.height();var l=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",l);var o=(m-l);this.$vscroll.pqScrollBar("option","length",o);var r=this.options.groupModel;var n=(r&&r.grouping=="local")?this.dataGM:this.data;var k=n?n.length:0;var s=0,p=0;if(k>=0&&this.$tbl){var j=this.$cont[0].offsetHeight;var i=this.$tbl[0].offsetHeight;if(i>j-l){var h=this.$tbl.children().children("tr");var q=0,g=0;h.each(function(t,u){q+=u.offsetHeight;if(q>=j-l){g=(t>1)?(t-1):0;return false}});s=k-g+1}else{s=this.init+1}if(s<2&&k>1){if(i>j-l){s=2}}}this.$vscroll.pqScrollBar("option",{num_eles:s})};d._setInnerGridHeight=function(){var g=(this.element.outerHeight()-((this.options.topVisible)?this.$top[0].offsetHeight:0)-this.$bottom.outerHeight());this.$grid_inner.height(g+"px")};d._setRightGridHeight=function(){this.$header_o.height(this.$header_left.height()-2);var g=(this.element[0].offsetHeight-this.$header_o[0].offsetHeight-((this.options.topVisible)?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight);this.$cont.height(g+"px")};d._setGridHeightFromTable=function(){var i=0;var h=17;if(this.$hscroll.css("visibility")=="hidden"){h=0}if(this.$tbl){i=this.$tbl[0].offsetHeight+h}else{i=h+h}this.$cont.height(i+"px");var g=(this.$header_o[0].offsetHeight+this.$top[0].offsetHeight+this.$bottom[0].offsetHeight+i);this.element.height(g);this._setInnerGridHeight();this.$vscroll.css("visibility","hidden")};d._setGridWidthFromTable=function(){var g=17;if(this.$vscroll.css("visibility")=="hidden"||this.$vscroll.css("display")=="none"){g=0}if(this.$tbl){this.element.width((this.$tbl[0].offsetWidth+g)+"px")}else{var h=this.$header_left.find("table")[0].offsetWidth;this.element.width((h)+"px")}};d._setRightGridWidth=function(){};d._bufferObj_getInit=function(){return this.init};d._bufferObj_getFinal=function(){return this["final"]};d._bufferObj_minRowsPerGrid=function(){var g=this.$cont[0].offsetHeight;return Math.ceil(g/this.rowHeight)};d._bufferObj_calcInitFinal=function(){var j=this.options.groupModel,h=(j&&j.grouping=="local")?true:false,i=h?this.dataGM:this.data;if(i==null||i.length==0){this["final"]=this["init"]=null}else{if(this.options.flexHeight){this.init=0;this["final"]=i.length-1}else{var g=parseInt(this.$vscroll.pqScrollBar("option","cur_pos"));if(isNaN(g)||g<0){this.init=0}else{this.init=g}if(this.init+1>i.length){this.init=i.length-1}this["final"]=this.init+this._bufferObj_minRowsPerGrid();if(this["final"]+1>i.length){this["final"]=i.length-1}}}};d._bufferObj_calcInitFinalH=function(){var g=parseInt(this.$hscroll.pqScrollBar("option","cur_pos"));var k=0;var j=0;for(var h=this.freezeCols;h<this.colModel.length;h++){if(this.colModel[h].hidden){k++}else{if(j==g){break}else{k++;j++}}}this.initH=k};d._calcWidthCols=function(j){var h=0;if(this.numberCell){h+=this.numberCell_outerWidth}for(var g=0;g<=j;g++){if(!this.colModel[g].hidden){h+=this.outerWidths[g]}}return h};d._calcRightEdgeCol=function(k){var h=0,j=0;if(this.numberCell){h+=this.numberCell_outerWidth;j++}for(var g=0;g<=k;g++){if(!this.colModel[g].hidden&&this.hidearrHS[g]==false){h+=this.outerWidths[g];j++}}return{width:h,cols:j}};d._refreshFreezeLine=function(){return;if(this.$freezeLine){this.$freezeLine.remove()}this.$freezeLine=f("<div style='position:absolute;width:1px;z-index:100;'></div>").appendTo(this.$grid_inner);var g=this.$grid_inner.outerHeight();var i=f("td[pq-grid-col-indx="+this.freezeCols+"]",this.$header)[0];var h=this._calcWidthCols(this.freezeCols-1)-1;this.$freezeLine.height(g).css({backgroundColor:"blue",top:"0",left:h})};d._getDragHelper=function(h){var g=f(h.currentTarget);this.$cl=f("<div style='position:absolute;width:1px;z-index:100;'></div>").appendTo(this.$grid_inner);this.$clleft=f("<div style='position:absolute;width:1px;z-index:100'></div>").appendTo(this.$grid_inner);var j=parseInt(g.attr("pq-grid-col-indx"));var i=this.$grid_inner.outerHeight();this.$cl.height(i);this.$clleft.height(i);var l=f("td[pq-grid-col-indx="+j+"]",this.$header)[0];var k=l.offsetLeft+((j>this.options.freezeCols)?parseInt(this.$header[1].style.left):0);this.$clleft.css({backgroundColor:"#000",top:"0",left:k});k=k+l.offsetWidth;this.$cl.css({backgroundColor:"#000",top:"0",left:k})};d._setDragLimits=function(n){var m=this;var g=m.$header_left;if(n>=this.options.freezeCols){g=m.$header_right}var l=g.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+n+"]");var i=g.find("td.pq-grid-col[pq-grid-col-indx="+n+"]");var k=i.offset().left+m.minWidth;var h=17;if(this.options.flexHeight||this.$vscroll.css("visibility")=="hidden"){h=0}var j=m.$cont.offset().left+m.$cont[0].offsetWidth-h+20;l.draggable("option","containment",[k,0,j,0])};d._getOrderIndx=function(h){var g=this.options.columnOrder;if(g!=null){return g[h]}else{return h}};d.nestedCols=function(r,q,s){var p=r.length;var n=[];if(q==null){q=1}var m=q,o=0,g=0,j=0;for(var l=0;l<p;l++){var h=r[l];if(s==true){h.hidden=s}if(h.colModel!=null){var k=this.nestedCols(h.colModel,q+1,h.hidden);n=n.concat(k.colModel);if(k.colSpan>0){if(k.depth>m){m=k.depth}h.colSpan=k.colSpan;o+=k.colSpan}else{h.colSpan=0;h.hidden=true}h.childCount=k.childCount;j+=k.childCount}else{if(h.hidden){h.colSpan=0}else{h.colSpan=1;o++}h.childCount=0;j++;n.push(h)}}return{depth:m,colModel:n,colSpan:o,width:g,childCount:j}};d.getHeadersCells=function(){var q=this.options.colModel,y=this.colModel.length,z=this.depth;var h=[];for(var o=0;o<z;o++){h[o]=[];var w=0;var p=0,j=0;for(var n=0;n<y;n++){var r;if(o==0){r=q[w]}else{var l=h[o-1][n];var m=l.colModel;if(m==null){r=l}else{var v=(n-l.leftPos);var s=0,i=0;var g=0;for(var u=0;u<m.length;u++){i+=(m[u].childCount>0)?m[u].childCount:1;if(v<i){g=u;break}}r=m[g]}}var x=(r.childCount)?r.childCount:1;if(n==j){r.leftPos=n;h[o][n]=r;j+=x;w++}else{h[o][n]=h[o][n-1]}}}this.headerCells=h;return h};d.assignRowSpan=function(){var k=this.options.colModel,g=this.colModel.length,n=this.headerCells,i=this.depth;for(var h=0;h<g;h++){for(var p=0;p<i;p++){var m=n[p][h];if(h>0&&m==n[p][h-1]){continue}else{if(p>0&&m==n[p-1][h]){continue}}var l=1;for(var o=p+1;o<i;o++){var j=n[o][h];if(m==j){l++}}m.rowSpan=l}}return n};d._refreshHeader=function(){var g=this.nestedCols(this.options.colModel);this.colModel=g.colModel;this.depth=g.depth;this.getHeadersCells();this.assignRowSpan()};d._refreshWidths=function(){var g=this;f(this.colModel).each(function(j,h){if(h.width!=undefined){var k=parseInt(h.width);if(k<g.minWidth){k=g.minWidth;h.width=k}}else{h.width=g.minWidth}})};d._createHeader=function(){var s=this;var F="<table class='pq-grid-header-table' cellpadding=0 cellspacing=0>";var E=[];var v=this.options.colModel,C=v.length,D=this.colModel,H=D.length,L=this.depth,I=this.headerCells;if(L>=1){F+="<tr>";if(this.numberCell){F+="<td style='width:"+this.numberCellWidth+"px;visibility:hidden;' ></td>"}for(var q=0;q<H;q++){var l=D[q];if(l.hidden){continue}var u=parseInt(l.width)-((this.columnBorders)?0:1);F+="<td style='width:"+u+"px;visibility:hidden;'></td>"}F+="</tr>"}for(var r=0;r<L;r++){F+="<tr>";if(r==0&&this.numberCell){F+="<td rowspan='"+L+"'>				<div class='pq-grid-header-table-div'>&nbsp;</div></td>"}for(var q=0;q<H;q++){var l=I[r][q];var t=l.colSpan;if(r>0&&l==I[r-1][q]){continue}else{if(q>0&&l==I[r][q-1]){continue}}if(l.hidden){continue}var k="pq-grid-col";if(l.align=="right"){k+=" pq-align-right"}else{if(l.align=="center"){k+=" pq-align-center"}}if(q==s.freezeCols-1&&L==1){k+=" pq-last-freeze-col"}var B="",z="";if(l.colModel==null){B="pq-grid-col-indx='"+q+"'"}F+="<td "+B+" "+z+" class='"+k+"' rowspan="+l.rowSpan+" colspan="+t+">				<div class='pq-grid-header-table-div' >"+l.title+"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"}F+="</tr>"}F+="</table>";this.$header.empty();this.$header.append(F);var p=f(this.$header[0]);var h=f(this.$header[1]);var y=parseInt(this.options.freezeCols);var u=this._calcWidthCols(y-1);p.css({width:u,zIndex:1});var M=0;for(var G=y;G<(this.initH+y);G++){var l=D[G];if(l.hidden){continue}var K=this.outerWidths[G];if(K==null){throw ("Assert: unknown width")}M+=K}h.css({left:"-"+M+"px"});this.$header.find("td").click(function(){if(!s.options.sortable){return}var Q=f(this).attr("pq-grid-col-indx");if(Q==null){return}var P=s.colModel[Q];if(P.sortable==false){return}var O=P.dataIndx;if(s._trigger("beforeSort",null,{dataModel:s.dataModel,data:s.data,sortIndx:O})==false){return}var N="up";var i=s.options.dataModel;if(i.sortIndx==O){N=(i.sortDir=="up")?"down":"up"}i.sortIndx=O;i.sortDir=N;s._refreshSortingDataAndView({sorting:true,keepSelection:true,fn:function(){s._trigger("sort",null,{dataModel:s.dataModel,data:s.data})}})});var M=0;var A=s.$header[0].offsetHeight;for(var G=0;G<this.colModel.length;G++){var x=s.colModel[G];if(s.hidearrHS[G]){continue}else{if(x.hidden){continue}}if(x.resizable!=undefined&&x.resizable==false){continue}var w=s.$header_left;if(G>=s.options.freezeCols){w=s.$header_right}var j=f("<div pq-grid-col-indx='"+G+"' class='pq-grid-col-resize-handle'>&nbsp;</div>").appendTo(w);var J=s.$header_right.find("td[pq-grid-col-indx="+G+"]")[0];M=J.offsetLeft+J.offsetWidth-10;j.css({left:M,height:A})}var o,n,m;var g=s.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(N,P){var i=f(N.target);var O=parseInt(i.attr("pq-grid-col-indx"));s._setDragLimits(O);s._getDragHelper(N,P);return i},start:function(i,N){o=N.position.left;m=parseInt(s.$cl[0].style.left)},drag:function(i,O){n=O.position.left;var N=(n-o);s.$cl[0].style.left=m+N+"px"},stop:function(N,Q){s.$clleft.remove();s.$cl.remove();n=Q.position.left;var O=(n-o);var i=f(Q.helper);var R=parseInt(i.attr("pq-grid-col-indx"));var P=s.colModel[R];P.width=parseInt(P.width)+O;s._computeOuterWidths(true);s._refresh()}})};d._refreshHeaderSortIcons=function(){var g=this.options.dataModel;if(g.sortIndx==undefined){return}var i=this.$header.find(".pq-grid-col");i.removeClass("pq-col-sort-asc pq-col-sort-desc");var j=g.sortIndx;var h=this.getColIndxFromDataIndx(j);this.$header.find(".pq-grid-col[pq-grid-col-indx="+h+"]").addClass("pq-col-sort-"+(g.sortDir=="up"?"asc":"desc"))};d._generateRow=function(p,o,t,u,C,v,m,A,y,i){var q="pq-grid-row",g="";if(o/2==parseInt(o/2)){q+=" pq-grid-oddRow"}if(t&&t.pqData&&t.selectedRow){q+=" pq-row-select"}g+="<tr pq-row-indx='"+o+"' class='"+q+"'>";y.push(g);if(this.numberCell){y.push("<td style='width:"+this.numberCellWidth+"px;' class='pq-grid-number-cell pq-row-selector'>		<div class='pq-td-div'>"+((i)?"&nbsp;":(o+1))+"</div></td>")}var z={rowIndx:o+m,rowIndxPage:o,rowData:p};for(var l=0;l<C;l++){var j=u[l],s=j.dataIndx;z.column=j;z.colIndx=l;var r=false;var n=t.selectedDataIndices;if(n){r=n[s]}if(j.hidden){continue}else{if(this.hidearrHS[l]){continue}}var B="";var h=A;if(j.align=="right"){h+=" pq-align-right"}else{if(j.align=="center"){h+=" pq-align-center"}}if(l==this.freezeCols-1&&this.columnBorders){h+=" pq-last-freeze-col"}if(j.className){h=h+" "+j.className}if(r){h=h+" pq-cell-select"}var w="<td class='"+h+"' style='"+B+"' pq-col-indx='"+l+"'>			"+this._renderCell(z)+"</td>";y.push(w)}for(var x=0;x<v.length;x++){var l=v[x];var j=u[l];z.column=j;z.colIndx=l;var B="";B+="visibility:hidden;";var h=A;if(j.align=="right"){h+=" pq-align-right"}else{if(j.align=="center"){h+=" pq-align-center"}}var w="<td class='"+h+"' style='"+B+"' pq-col-indx='"+l+"'>			"+this._renderCell(z)+"</td>";y.push(w)}y.push("</tr>");return y};d._generateSummaryRow=function(o,n,s,t,C,v,l,A,y){var p="pq-summary-row",g="";g+="<tr pq-row-indx='"+n+"' class='"+p+"'>";y.push(g);if(this.numberCell){y.push("<td style='width:"+this.numberCellWidth+"px;' class='pq-grid-number-cell pq-row-selector'>		<div class='pq-td-div'></div></td>")}var z={rowIndx:n+l,rowIndxPage:n,rowData:o,summaryCell:true};for(var j=0;j<C;j++){var i=t[j],r=i.dataIndx;z.column=i;z.colIndx=j;var q=false;var m=s.selectedDataIndices;if(m){q=m[r]}if(i.hidden){continue}else{if(this.hidearrHS[j]){continue}}var B="";var h=A;if(i.align=="right"){h+=" pq-align-right"}else{if(i.align=="center"){h+=" pq-align-center"}}if(j==this.freezeCols-1&&this.columnBorders){h+=" pq-last-freeze-col"}if(i.className){h=h+" "+i.className}if(q){h=h+" pq-cell-select"}var u=(o[r]==null)?"":o[r];var w="<td class='"+h+"' style='"+B+"' >			<div>"+u+"</div></td>";y.push(w)}for(var x=0;x<v.length;x++){var j=v[x];var i=t[j],r=i.dataIndx;z.column=i;z.colIndx=j;var B="";B+="visibility:hidden;";var h=A;if(i.align=="right"){h+=" pq-align-right"}else{if(i.align=="center"){h+=" pq-align-center"}}var u=(o[r]==null)?"":o[r];var w="<td class='"+h+"' style='"+B+"' >			<div>"+u+"</div></td>";y.push(w)}y.push("</tr>");return y};d.createTable=function(g){this._generateTables(g)};d._generateTables=function(i){var H=this.colModel.length,u=this.options,A=u.scrollModel,q=this.$cont[0].offsetHeight;this._bufferObj_calcInitFinal();var o=(i)?0:this.init,l=(i)?i.data.length-1:this["final"],F="",y=(x&&x.grouping=="local")?true:false,G=(i&&i.data)?i.data:(y?this.dataGM:this.data),n=this.getRowIndxOffset();if(!i&&(o==null||l==null)){this.$cont.empty();this.$tbl=null;return}if(!i){this._trigger("beforeTableView",null,{data:this.data,curPos:o,finalPos:l,curPage:this.dataModel.curPage})}var E="pq-grid-cell ";if(this.columnBorders){E+="pq-grid-td-border-right "}if(!u.wrap||i){E+="pq-wrap-text "}var D=["<table class='pq-grid-table' cellpadding=0 cellspacing=0>"];var z=this.colModel,x=u.groupModel,B=[];D.push("<tr class='pq-row-hidden'>");if(this.numberCell){var r=this.numberCellWidth+1;D.push("<td style='width:"+r+"px;' ></td>")}for(var m=0;m<H;m++){var j=z[m];if(j.hidden){continue}else{if(this.hidearrHS[m]){B.push(m);continue}}var r=this.outerWidths[m];D.push("<td style='width:"+r+"px;'></td>")}for(var C=0;C<B.length;C++){var m=B[C];var j=z[m];var r=this.outerWidths[m];D.push("<td style='width:"+r+"px;visibility:hidden;'></td>")}D.push("</tr>");this.offsetRow=null;do{var h=G[o],t=y?h.data:h,s=y?h.rowIndx:o,w=(t)?t[t.length-1]:null,g="";if(this.offsetRow==null&&s!=null){this.offsetRow=(o-s)}if(x&&h.groupTitle){var v=this._calcRightEdgeCol(this.colModel.length-1);g="<tr class='pq-group-row'><td colspan='"+v.cols+"' style='width:"+v.width+"px;'><div>"+h.groupTitle+"</div></td></tr>";D.push(g)}else{if(x&&h.groupSummary){this._generateSummaryRow(t,s,w,z,H,B,n,E,D)}else{this._generateRow(t,s,w,z,H,B,n,E,D,i)}}if(A.scrollTillLastRow){}else{if(o==l){break}o++}}while(1==1);this.scrollMode=false;var p=this;if(!A.scrollTillLastRow){f.measureTime(function(){D.push("</table>");var k=D.join("");if(i){i.$cont.empty();i.$cont.append(f(k))}else{if(p.$tbl==undefined){p.$tbl=f(k);p.$cont.append(p.$tbl)}else{if(p.$td_edit!=null){p.quitEditMode()}p.$cont.empty();p.$tbl=f(k);p.$cont.append(p.$tbl)}}},"append stuff inside _generateTable")}if(!i){window.setTimeout(function(){p._fixTableViewPort();p._trigger("refresh",null,{dataModel:p.dataModel,data:p.data,initV:p.init,initH:p.initH})},0)}};d._renderCell=function(r){var g=r.rowIndxPage,l=r.rowIndx,j=r.rowData,i=r.colIndx,h=r.$td,k=r.column,q=(r.customData)?r.customData:this.options.customData;var p;var m=k.dataIndx;if(k.render){p=k.render({data:this.data,dataModel:this.dataModel,rowData:j,rowIndxPage:g,rowIndx:l,colIndx:i,column:k,dataIndx:m,customData:q})}else{p=j[m]}if(p==""||p==undefined){p="&nbsp;"}var o="pq-td-div";if(this.options.wrap==false){o+=" pq-wrap-text"}var n="<div class='"+o+"'>"+p+"</div>";if(h!=undefined){h.html(n)}return n};d._sortLocalData=function(k,j,i,l){var h=j;if(l==null||l.length==0){return}function g(){function q(u,t){var s=u[k];var r=t[k];s=s?parseInt(s):0;r=r?parseInt(r):0;return(s-r)}function m(u,t){var s=u[k];var r=t[k];return i(s,r)}function p(u,t){var s=(u[k]+"").replace(/,/g,"");var r=(t[k]+"").replace(/,/g,"");s=s?parseFloat(s):0;r=r?parseFloat(r):0;return(s-r)}var n=0;function o(u,t){n++;var s=u[k];var r=t[k];s=s?s:"";r=r?r:"";if(s>r){return 1}else{if(s<r){return -1}}return 0}if(i=="integer"){l=l.sort(q)}else{if(i=="float"){l=l.sort(p)}else{if(typeof i=="function"){l=l.sort(m)}else{l=l.sort(o)}}}if(h=="down"){l=l.reverse()}}f.measureTime(g,"innerSort")};f.widget("paramquery.pqGrid",d);f.measureTime=function(k,j){var h=(new Date()).getTime();k();var g=(new Date()).getTime();var i=g-h}})(jQuery);var cons={log:function(d){try{if(document.compatMode&&document.all&&typeof d=="object"){throw""}console.log(d)}catch(c){var a="";if(typeof d=="object"){for(var b in d){if(typeof d[b]!="function"){a+=b+" = "+d[b]}}}else{if(document.getElementById("console")==undefined){$("<textarea id='console' rows=8 cols=100>"+d+"</textarea>").appendTo(document.body)}var f=$("#console");f.text(f.text()+"\r\n"+d);f[0].scrollTop=10000000000000}}}};